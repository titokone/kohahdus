\section{Johdanto}

Kohahdus on järjestelmä automaattisesti tarkastettavien TTK-91-konekielen harjoitustehtävien 
luomiseen ja ratkaisemiseen. Järjestelmä on tarkoitettu käytettäväksi opetuksen tukena, 
opetettaessa Tietokoneen toiminta -kurssia. Tietojenkäsittelytieteen opettajat voivat tehdä 
järjestelmään uusia tehtäviä ja määritellä kuinka ne tarkastetaan automaattisesti. 
Tietokoneen toiminta -kurssin opiskelijat ja kurssin tehtävistä kiinnostuneet itseopiskelijat 
voivat ratkaista tehtäviä ja saada palautetta niiden onnistumisesta.

Painopiste projektissa on opettajan ja opiskelijan käyttöliittymillä. Käyttöliittymistä tehdään 
mahdollisimman selkeät ja helppokäyttöiset. Opettajan käyttöliittymän avulla määritellään tehtävät 
parametreineen ja kuinka opiskelijan ratkaisun oikeellisuus tarkistetaan, sekä nähdään statistiikkatietoja 
opiskelijoiden suorituksista. Opiskelijan käyttöliittymän avulla opiskelija valitsee tehtäviä, 
syöttää niiden ratkaisut ja saa palautetta vastauksensa oikeellisuudesta.

Projekti käyttää valmiina olevaa Titokone-simulaattoria harjoitustehtävien ratkaisemiseen. Projekti 
rakennetaan valmiina olevaan eAssari-kehykseen, joka sopii geneeriseen automaattisesti 
tarkistettavien tehtävien määrittelyyn ja toteutukseen.

Järjestelmä toteutetaan Java-kielellä ja järjestelmän käyttö vaatii, että selain tukee 
JavaScript-kieltä ja CSS-tyylitiedostoja. Järjestelmä toimii uusimmilla Firefox ja Internet 
Explorer-selaimilla.



\section{Sanasto}

\input{termit}



\section{Toiminnot}

Tämä lukuu kuvaa järjestelmän HTML-sivut ja sen, mitä toimintoja ne tarjoavät käyttäjälle.

\subsection{Rekisteröityminen}

Rekiströintisivulla opiskelija rekisteröityy järjestelmän käyttäjäksi. Rekisteröinti vaatii seuraavat 
tiedot: etunimi, sukunimi, sähköposti, opiskelijanumero tai henkilötunnus, sekä vapaavalintainen 
tunnus ja salasana

\subsection{Käyttäjätietojen muokkaaminen}

Käyttäjätietosivulla sisäänkirjautunut käyttäjä voi muokata rekisteröintitietojaan, poislukien 
tunnus joka on valittu rekisteröidyttäessä. 

\subsection{Kirjautuminen}

Kirjautumissivulla käyttäjä syöttää tunnuksensa, salasanansa ja pudotusvalikosta kurssin nimi.
Kurssivalinta määrittää, että minkä kurssin suorituksiin opiskelijan tekemät vastaukset tallennetaan.
Opettajan ollessa kyseessä kurssivalinnalla ei ole merkitystä. Jos kirjautuminen onnistuu, näytetään
tehtävälistaus. Jos kirjautuminen epäonnistuu, käyttäjä palautetaan kirjautumissivulle.

\subsection{Kurssien ja tehtävien valinta (opettaja)}

Kirjautumisen jälkeen opettajalle näytetään kurssilistaus josta opettaja voi siirtyä
kurssin statistiikka-sivulle. Kurssilistauksesen alla on myös lomake uuden kurssin
luomista varten.

Samalla sivulla näytetään myös tehtävälista. Listassa näytetään tehtävän kieli, aihepiiri
ja nimi, sekä viimeinen muokkauspäivä ja muokkaaja. Listattuja tehtäviä voi muokata ja
poistaa, sekä käynnistää uuden tehtävän luomisen.

\subsection{Tehtävän määrittely (opettaja)}

Tehtävänmäärittelysivulla opettaja voi luoda uuden tehtävän tai muokata olemassa olevaa
tehtävää. Tehtävälle määritellään nimi, tehtävänanto, tarkastustyyppi (malliratkaisu/kiinteät arvot),
tehtävätyyppi (täyttötehtävä/ohjelmointitehtävä), sekä tarkastuskriteerit ja kriteerien palautteet.

\subsection{Kurssin statistiikka (opettaja)}
Kurssin statistiikkasivulla opettajalle näytetään lista kaikkien kurssin tehtäviän suorittaneiden
opiskelijoiden suorituksista. Listassa näytetään opiskelijan nimi, opiskelijanumero tai henkilötunnus,
sekä onnistuneesti ratkaistujen tehtävien määrä. Lista on helposti tulostettavassa muodossa.

Listassa opiskelijan nimi toimii linkkinä ko. opiskelijan käyttäjätietosivulle.

\subsection{Käyttäjän tiedot (opettaja)}
Käyttäjän statistiikkasivulla opettajalle näytetään opiskelijan tarkemmat tiedot.
Listassa näkyy salasanaa lukuunottamatta kaikki rekisteröintitiedot.

\subsection{Tehtävien valinta (opiskelija)}

Kirjautumisen jälkeen opiskelijalle näytetään tehtävälista, josta opiskelija voi valita
tehtävän ratkaistavaksi. Listassa näytetään tehtävän kieli, aihepiiri ja nimi, sekä tieto
onko opiskelija yrittänyt jo tehtävän suoritusta ja onko yritys onnistunut.

\subsection{Tehtävään vastaaminen (opiskelija)}

Opiskelijan ratkaistavaksi valitsemasta tehtävästä näytetään nimi ja tehtävänanto,
mahdollinen valmis koodi mikäli kyseessä on täyttötehtävä, sekä tekstialue johon
opiskelija kirjoittaa vastauksensa. Lisäksi on linkki jolla pääsee takaisin tehtävälistaukseen.

Kun opiskelija on kirjoittanut vastauksensa, hän painaa "Suorita" nappia joka vie
takaisin tehtävävastaussivulle. Sivulla näytetään samat tiedot kuin alussa, mutta
lisäksi näytetään palautetta tehtävän ratkaisun onnistumisesta/epäonnistumisesta.

\section{Arkkitehtuurisuunnitelma}

Järjestelmä on jaettu kahteen osajärjestelmään, Titokone ja eAssari/kohahdus. Ideaalitapaus
olisi ollut kolme osajärjestelmää, jossa eAssari on kohahdusta käyttävä sovelluskehys. Tämä
malli ei kuitenkaan ole mahdollinen johtuen eAssarin keskeneräisyydestä. Lopputuotteelle 
asettujen vaatimusten täyttäminen vaatii huomattavia lisäyksiä eAssariin, mm. puuttuvat
kurssien ja käyttäjien hallinta täytyy tehdä. Kireän aikataulun vuoksi eAssaria ei yritetä
säilyttää geneerisenä kehyksenä, vaan muokkauset tehdään vain Kohahdus projektin tarpeita
ajatellen. Käytännössä eAssarista tehdään siis ns. code fork, eli synnytetään täysin
Kohahdus-spesifinen eAssari-versio joka ei ole yhteensopiva geneerisen eAssarin kanssa.

Ainoa osuus eAssarista jota pyritään käyttämään sen alkuperäisen arkkitehtuurin mukaan,
on tehtävien tarkistus eli Answer-servlet ja Analyzer sekä Feedback rajapinnat. Tietokannan
rakennetta ei myöskään muuteta, mutta kaikkia tauluja ei käytetä (kts. tämän dokumentin
luku Tietokanta).

Titokonetta käytetään sen TTK91-rajapintojen kautta, joita muokataan tarpeen mukaan jotta
vaatimuksissa esitetyt tehtävien tarkistukset ja suorituksenaikaiset tilastot saadaan 
toteutettua. Titokoneen käytön ja muokkauksen yksityiskohdat jätetään toisen iteraation
asioiksi.







\section{Tietokanta}

Tietotokannan rakenteen määrää eAssari kehys. Rakenne on kuvattu liitteessä 1. Ajanpuutteesta johtuen
module-tietokantataulua ei tulla käyttämään sen mahdollistamassa laajuudessa. Kyseisestä taulusta
luodaan vain yksi rivi kantaan, johon sitten viitataan muista tauluista. Lisäksi jokainen tehtävä
sisältyy jokaiseen kurssiin. Eli kun tehtävä luodaan, niin se liitetään jokaiseen kurssiin. Lisäksi 
kun kurssi luodaan, niin jokainen tehtävä lisätään kyseiseen uuteen kurssiin. Tämä linkitys tapahtuu
"taskinmodule"-tietokantataulussa. 

Tietokantaa käytetään aina DBHandler-luokan kautta, joka piilottaa tietokanta rakenteen yksityiskohdat.
Eli SQL-lauseita tulee vain ks. luokkaan eikä muualle koodiin. DBHandler-luokasta voidaan luoda instanssi
staattisen DBHandler.getInstance() -metodin avulla. Tämä tarkoittaa sitä, että ko. luokkaa voidaan 
käyttää virtuaalikoneen sisällä mistä vaan.

\section{Osajärjestelmät}



\section{Komponentit}



\section{Luokat}

\input{docs}


DBConnectionPool
Analyzer
Displayer
Feedback
Composer
+jsp:t eri toiminnoille

% Nämä kesken (eikä pitänyt edes vielä suunnitella)
%public abstract class Criterion 
%	abstract boolean isValidAnswer(String answer)
%	String getFailureFeedback()
%	String getSuccessFeedback()
%	boolean isQualityCriterion()
%public abstract class SingleValueCriterion extends Criterion 
%	boolean isValidAnswer(String answer)
%	void setTestValue(int value)
%	void setTestOperator(int optype)












